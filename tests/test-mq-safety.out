% try to commit on top of a patch
abort: cannot commit over an applied mq patch
% qpop/qrefresh on the wrong revision
abort: popping would remove a revision not managed by this patch queue
using patch queue:
abort: popping would remove a revision not managed by this patch queue
abort: working directory revision is not qtip
1 files updated, 0 files merged, 0 files removed, 0 files unresolved
% qpop
abort: popping would remove a revision not managed by this patch queue
% qrefresh
abort: cannot refresh a revision with children
% tip:
3 append quux
% qpush warning branchheads
popping qp
patch queue now empty
adding a
0 files updated, 0 files merged, 1 files removed, 0 files unresolved
marked working directory as branch b
adding c
1 files updated, 0 files merged, 0 files removed, 0 files unresolved
(branch merge, don't forget to commit)
0 files updated, 0 files merged, 1 files removed, 0 files unresolved
changeset:   2:65309210bf4e
branch:      b
tag:         tip
parent:      1:707adb4c8ae1
parent:      0:cb9a9f314b8b
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     merge

changeset:   1:707adb4c8ae1
branch:      b
parent:      -1:000000000000
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     c

changeset:   0:cb9a9f314b8b
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     a

applying qp
now at: qp
% testing applied patches, push and --force
adding a
1 files updated, 0 files merged, 0 files removed, 0 files unresolved
marked working directory as branch branch
adding b
0 files updated, 0 files merged, 1 files removed, 0 files unresolved
requesting all changes
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved
% pushing applied patch with --rev without --force
pushing to ../forcepush2
abort: source has mq patches applied
% pushing applied patch with branchhash, without --force
pushing to ../forcepush2
abort: source has mq patches applied
% pushing revs excluding applied patch
pushing to ../forcepush2
searching for changes
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
% pushing applied patch with --force
pushing to ../forcepush2
searching for changes
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files (+1 heads)
